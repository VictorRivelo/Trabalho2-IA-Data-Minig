Implementation in Python from scratch